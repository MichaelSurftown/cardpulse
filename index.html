<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CardPulse ‚Äî Pok√©mon Market Dashboard</title>
<style>
  :root {
    --accent: #facc15;
    --bg1: #7f1d1d;
    --bg2: #b91c1c;
    --text: #f9fafb;
    --card-bg: rgba(0,0,0,0.35);
  }
  *{box-sizing:border-box;}
  body {
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    background: linear-gradient(145deg,var(--bg1),var(--bg2));
    color: var(--text);
    margin: 0;
    padding: 24px;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  h1 {
    font-size: 28px;
    text-align: center;
    margin-bottom: 28px;
    text-shadow: 0 0 8px rgba(0,0,0,0.5);
  }
  .cards {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    justify-content: center;
    width: 100%;
    max-width: 1100px;
    margin-bottom: 40px;
  }
  .card {
    flex: 1 1 300px;
    background: var(--card-bg);
    border-radius: 16px;
    padding: 20px;
    text-align: center;
    box-shadow: 0 0 20px rgba(0,0,0,0.4);
    transition: transform 0.3s, box-shadow 0.3s;
  }
  .card:hover {
    transform: translateY(-6px);
    box-shadow: 0 0 30px rgba(250,204,21,0.3);
  }
  .label { font-weight: 600; font-size: 16px; margin-bottom: 6px; color: var(--accent); }
  .score { font-size: 30px; font-weight: 700; }

  .section {
    width: 100%;
    max-width: 1200px;
    margin-bottom: 60px;
  }
  .section h2 {
    text-align: center;
    font-size: 22px;
    margin-bottom: 20px;
    color: var(--accent);
    text-shadow: 0 0 10px rgba(0,0,0,0.5);
  }

  .grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
    gap: 18px;
  }

  .mover {
    background: var(--card-bg);
    border-radius: 14px;
    padding: 12px;
    text-align: center;
    transition: transform 0.25s, box-shadow 0.25s;
    box-shadow: 0 0 10px rgba(0,0,0,0.4);
  }
  .mover:hover {
    transform: translateY(-5px);
    box-shadow: 0 0 20px rgba(250,204,21,0.3);
  }

  .mover img {
    width: 90px;
    height: auto;
    border-radius: 8px;
    margin-bottom: 6px;
    box-shadow: 0 0 8px rgba(0,0,0,0.6);
  }

  .mover div {
    font-size: 13px;
    margin-bottom: 2px;
  }

  .up { color: #4ade80; font-weight: 600; }
  .down { color: #f87171; font-weight: 600; }

  button.refresh {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: var(--accent);
    color: #000;
    border: none;
    border-radius: 10px;
    padding: 10px 16px;
    font-weight: 600;
    cursor: pointer;
    box-shadow: 0 0 10px rgba(250,204,21,0.4);
    transition: transform 0.2s, box-shadow 0.2s;
  }
  button.refresh:hover {
    transform: scale(1.05);
    box-shadow: 0 0 20px rgba(250,204,21,0.6);
  }

  footer {
    font-size: 12px;
    color: #e5e7eb;
    margin-top: 40px;
    text-align: center;
    opacity: 0.8;
  }

  @media (max-width:600px){
    .cards {flex-direction: column; align-items:center;}
    .card {width:90%;}
  }
</style>
</head>
<body>
  <h1>CardPulse ‚Äî Pok√©mon Market Dashboard</h1>

  <div class="cards">
    <div class="card" id="card1d"><div class="label">1-Day Heat</div><div class="score">‚Äî</div></div>
    <div class="card" id="card7d"><div class="label">7-Day Heat</div><div class="score">‚Äî</div></div>
    <div class="card" id="card30d"><div class="label">30-Day Heat</div><div class="score">‚Äî</div></div>
  </div>

  <div class="section">
    <h2>üí∞ Top 10 to Buy Now</h2>
    <div id="buy-list" class="grid"></div>
  </div>

  <div class="section">
    <h2>üî• Top 10 to Sell Now</h2>
    <div id="sell-list" class="grid"></div>
  </div>

  <button class="refresh" id="refresh">üîÅ Refresh</button>
  <footer>Live data via Pok√©mon Price Tracker API ‚Äî Cached hourly by CardPulse</footer>

<script>
const SUMMARY_URL = "https://cardpulse-proxy.michael-e59.workers.dev/summary";

async function buildDashboard() {
  try {
    const res = await fetch(SUMMARY_URL, { cache: "no-store" });
    const data = await res.json();

    if (!data.market_heat) {
      document.body.insertAdjacentHTML("beforeend","<p style='text-align:center;color:#f87171;'>Market data not ready yet ‚Äî please check back soon.</p>");
      return;
    }

    const setCard = (id,label,value)=>{
      const el=document.getElementById(id);
      el.querySelector(".label").textContent=label;
      el.querySelector(".score").textContent=(value>0?"+":"")+value.toFixed(2)+"%";
    };
    setCard("card1d","üî• 1-Day Heat",data.market_heat["1d"]);
    setCard("card7d","üìÖ 7-Day Heat",data.market_heat["7d"]);
    setCard("card30d","üìà 30-Day Heat",data.market_heat["30d"]);

    const gridItem=(c,type)=>`
      <div class="mover ${type}">
        <img src="${c.img||''}" alt="${c.name}">
        <div>${c.name}</div>
        <div class="${type==='up'?'up':'down'}">${c.change.toFixed(2)}%</div>
      </div>`;

    document.getElementById("buy-list").innerHTML=(data.top_buy||[]).map(c=>gridItem(c,"down")).join("");
    document.getElementById("sell-list").innerHTML=(data.top_sell||[]).map(c=>gridItem(c,"up")).join("");
  } catch(err) {
    console.error(err);
    document.body.insertAdjacentHTML("beforeend","<p style='text-align:center;color:#f87171;'>Failed to load market data.</p>");
  }
}

document.getElementById("refresh").addEventListener("click",buildDashboard);
buildDashboard();
setInterval(buildDashboard,5*60*1000);
</script>
</body>
</html>
